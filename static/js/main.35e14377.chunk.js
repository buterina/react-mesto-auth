(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,a){e.exports=a.p+"static/media/places-logo.bb94eb64.png"},19:function(e,t,a){e.exports=a.p+"static/media/success-icon.e38b395c.svg"},20:function(e,t,a){e.exports=a.p+"static/media/fail-icon.f10ac534.svg"},22:function(e,t,a){e.exports=a(38)},30:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(13),c=a.n(o),l=(a(30),a(21)),i=a(1),s=a(2),u=a(7),m="https://auth.nomoreparties.co",p=function(e){return e.ok?e.json():Promise.reject(e.status)},_=function(e,t){return fetch("".concat(m,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(p)},f=function(e,t){return fetch("".concat(m,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(p)},d=function(e){return fetch("".concat(m,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(p)},h=a(14),b=a.n(h),E=function(e){var t=e.children;return r.a.createElement("header",{className:"header"},r.a.createElement("a",{className:"logo",href:""},r.a.createElement("img",{className:"logo__image",src:b.a,alt:"Places Logo"})),r.a.createElement("nav",{className:"header__nav"},t))};var g=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa92022. Places"))},v=r.a.createContext();var N=function(e){var t=e.card,a=e.onCardClick,n=e.onCardLike,o=e.onCardDelete,c=r.a.useContext(v),l=t.owner._id===c._id,i="card__delete-button ".concat(l?"card__delete-button_visible":"card__delete-button_hidden"),s=t.likes.some(function(e){return e._id===c._id}),u="".concat(s?"card__like-button_filled":"card__like-button");return r.a.createElement("li",{className:"card"},r.a.createElement("img",{className:"card__photo",src:t.link,alt:t.name,onClick:function(){a(t)}}),r.a.createElement("button",{className:i,type:"button","aria-label":"Delete",onClick:function(){o(t)}}),r.a.createElement("div",{className:"card__place"},r.a.createElement("h2",{className:"card__title"},t.name),r.a.createElement("div",{className:"card__likes"},r.a.createElement("button",{className:u,type:"button",onClick:function(){n(t)},"aria-label":"Like"}),r.a.createElement("span",{className:"card__like-count"},t.likes.length))))};var C=function(e){var t=e.onEditProfile,a=e.onAddPlace,n=e.onEditAvatar,o=e.onCardClick,c=e.onCardLike,l=e.onCardDelete,i=e.cards,s=r.a.useContext(v);return r.a.createElement("main",{className:"main"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",{className:"profile__photo"},r.a.createElement("img",{className:"profile__avatar",src:s.avatar,alt:"Avatar"}),r.a.createElement("button",{className:"profile__avatar-button",type:"button","aria-label":"Edit avatar",onClick:n})),r.a.createElement("div",{className:"profile__description"},r.a.createElement("div",{className:"profile__name"},r.a.createElement("h1",{className:"profile__title"},s.name),r.a.createElement("button",{className:"profile__edit-button",type:"button","aria-label":"Edit profile",onClick:t})),r.a.createElement("p",{className:"profile__bio"},s.about))),r.a.createElement("button",{className:"profile__add-button",type:"button","aria-label":"Add avatar",onClick:a})),r.a.createElement("section",{className:"cards"},r.a.createElement("ul",{className:"cards__gallery"},i.map(function(e){return r.a.createElement(N,{key:e._id,card:e,onCardClick:o,onCardLike:c,onCardDelete:l})}))))};var k=function(e){var t=e.card,a=e.onClose;return r.a.createElement("article",{className:"popup popup_type_photo ".concat(t.link&&"popup_opened")},r.a.createElement("div",{className:"popup__container"},r.a.createElement("button",{className:"popup__close-button",type:"button","aria-label":"Close",onClick:a}),r.a.createElement("figure",{className:"popup__image"},r.a.createElement("img",{className:"popup__photo",src:t.link,alt:t.name}),r.a.createElement("figcaption",{className:"popup__caption"},t.name))))};var y=function(e){var t=e.name,a=e.children,n=e.isOpen,o=e.onClose,c=e.onSubmit;return r.a.createElement("article",{className:"popup popup_type_".concat(t," ").concat(n&&"popup_opened")},r.a.createElement("div",{className:"popup__container"},r.a.createElement("button",{className:"popup__close-button",type:"button","aria-label":"Close",onClick:o}),r.a.createElement("form",{className:"form",name:t,onSubmit:c,noValidate:!0},a)))};var S=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,o=e.buttonDisabled,c=e.buttonText,l=e.title,s=r.a.useContext(v),u=r.a.useState(""),m=Object(i.a)(u,2),p=m[0],_=m[1],f=r.a.useState(""),d=Object(i.a)(f,2),h=d[0],b=d[1];return r.a.useEffect(function(){_(s.name),b(s.about)},[s,t]),r.a.createElement(y,{name:"edit-profile",isOpen:t,onClose:a,buttonText:"Save",title:l,onSubmit:function(e){e.preventDefault(),n({name:p,about:h})}},r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"form__title"},l),r.a.createElement("label",{className:"form__field"},r.a.createElement("input",{className:"form__input form__input_type_name",value:p||"",onChange:function(e){_(e.target.value)},id:"name-input",type:"text",name:"name",placeholder:"Your name",minLength:"2",maxLength:"40",autoComplete:"off",required:!0}),r.a.createElement("span",{className:"form__input-error name-input-error"})),r.a.createElement("label",{className:"form__field"},r.a.createElement("input",{value:h||"",onChange:function(e){b(e.target.value)},className:"form__input form__input_type_about",id:"bio-input",type:"text",name:"about",placeholder:"Your occupation",minLength:"2",maxLength:"200",autoComplete:"off",required:!0}),r.a.createElement("span",{className:"form__input-error bio-input-error"})),r.a.createElement("button",{className:"form__button",disabled:o,type:"submit"},c)))};var O=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,o=e.buttonDisabled,c=e.buttonText,l=e.title,i=r.a.useRef();return r.a.createElement(y,{name:"edit-avatar",isOpen:t,onClose:a,buttonText:"Save",title:l,onSubmit:function(e){e.preventDefault(),n({avatar:i.current.value})}},r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"form__title"},l),r.a.createElement("label",{className:"form__field"},r.a.createElement("input",{className:"form__input form__input_type_avatar",type:"url",name:"avatar",id:"avatar-input",placeholder:"Avatar link",autoComplete:"off",ref:i,required:!0}),r.a.createElement("span",{className:"form__input-error avatar-input-error"})),r.a.createElement("button",{className:"form__button",disabled:o,type:"submit"},c)))};var j=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,o=e.buttonText,c=e.buttonDisabled,l=e.title,s=r.a.useState(""),u=Object(i.a)(s,2),m=u[0],p=u[1],_=r.a.useState(""),f=Object(i.a)(_,2),d=f[0],h=f[1];return r.a.useEffect(function(){p(""),h("")},[t]),r.a.createElement(y,{name:"add-card",isOpen:t,onClose:a,buttonText:"Save",title:"title",onSubmit:function(e){e.preventDefault(),n({name:m,link:d})}},r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"form__title"},l),r.a.createElement("label",{className:"form__field"},r.a.createElement("input",{className:"form__input form__input_type_card-name",onChange:function(e){p(e.target.value)},value:m||"",type:"text",name:"place",id:"place-input",placeholder:"Name",autoComplete:"off",minLength:"2",maxLength:"30",required:!0}),r.a.createElement("span",{className:"form__input-error place-input-error"})),r.a.createElement("label",{className:"form__field"},r.a.createElement("input",{className:"form__input form__input_type_card-link",onChange:function(e){h(e.target.value)},value:d||"",type:"url",name:"link",id:"link-input",placeholder:"Image link",autoComplete:"off",required:!0}),r.a.createElement("span",{className:"form__input-error link-input-error"})),r.a.createElement("button",{className:"form__button",disabled:c,type:"submit"},o)))};var x=function(e){var t=e.name,a=e.title,n=e.buttonText,o=e.isOpen,c=e.onClose,l=e.onSubmit;return e.card,r.a.createElement("article",{className:"popup popup_type_".concat(t," ").concat(o&&"popup_opened")},r.a.createElement("div",{className:"popup__container"},r.a.createElement("button",{className:"popup__close-button",onClick:c,type:"button","aria-label":"Close"}),r.a.createElement("h2",{className:"form__title form__title_type_confirmation"},a),r.a.createElement("form",{className:"form form_type_delete-confirm",name:t,onSubmit:function(e){e.preventDefault(),l()},noValidate:!0},r.a.createElement("button",{className:"form__button",type:"submit"},n))))},T=a(15),P=a(16),w=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(T.a)(this,e),this._headers=n,this._baseUrl=a}return Object(P.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject(e.status)}},{key:"getProfile",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then(function(t){return e._checkResponse(t)})}},{key:"updateAvatar",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(function(e){return t._checkResponse(e)})}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then(function(t){return e._checkResponse(t)})}},{key:"editProfile",value:function(e,t){var a=this;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(function(e){return a._checkResponse(e)})}},{key:"addCard",value:function(e,t){var a=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(function(e){return a._checkResponse(e)})}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(function(e){return t._checkResponse(e)})}},{key:"changeLikeCardStatus",value:function(e,t){var a=this;return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:t?"DELETE":"PUT",headers:this._headers}).then(function(e){return a._checkResponse(e)})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-37",headers:{authorization:"3e727ee1-ba8f-4f8d-8bd7-5fc4fbc0cf58","Content-Type":"application/json"}}),R=function(e){var t=e.loggedIn,a=e.children,n=e.path;return r.a.createElement(s.b,{path:n},t?a:r.a.createElement(s.a,{to:"/login"}))},L=function(e){var t=e.onLogin,a=Object(n.useState)(""),o=Object(i.a)(a,2),c=o[0],l=o[1],s=Object(n.useState)(""),u=Object(i.a)(s,2),m=u[0],p=u[1];return r.a.createElement("div",{className:"login"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(m,c)},className:"form"},r.a.createElement("h1",{className:"form__title form__title_theme_dark"},"Login"),r.a.createElement("label",{className:"form__field"},r.a.createElement("input",{className:"form__input form__input_theme_dark",type:"text",id:"login-email",placeholder:"E-mail",autoComplete:"off",value:c||"",onChange:function(e){l(e.target.value)},required:!0})),r.a.createElement("label",{className:"form__field"},r.a.createElement("input",{className:"form__input form__input_theme_dark",type:"password",id:"login-password",placeholder:"Password",autoComplete:"off",value:m||"",onChange:function(e){p(e.target.value)},required:!0})),r.a.createElement("button",{type:"submit",className:"form__button form__button_theme_dark"},"Log in")))},A=function(e){var t=e.onRegister,a=Object(n.useState)(""),r=Object(i.a)(a,2),o=r[0],c=r[1],l=Object(n.useState)(""),s=Object(i.a)(l,2),m=s[0],p=s[1];return n.React.createElement("div",{className:"register"},n.React.createElement("form",{onSubmit:function(e){e.preventDefault(),t(o,m)},className:"form"},n.React.createElement("h1",{className:"form__title form__title_theme_dark"},"Register"),n.React.createElement("label",{className:"form__field"},n.React.createElement("input",{className:"form__input form__input_theme_dark",type:"text",id:"register-email",placeholder:"E-mail",autoComplete:"off",value:m||"",onChange:function(e){p(e.target.value)},required:!0})),n.React.createElement("label",{className:"form__field"},n.React.createElement("input",{className:"form__input form__input_theme_dark",type:"password",id:"register-password",placeholder:"Password",autoComplete:"off",value:o||"",onChange:function(e){c(e.target.value)},required:!0})),n.React.createElement("button",{type:"submit",className:"form__button form__button_theme_dark"},"Register"),n.React.createElement("div",{className:"register__signup-prompt"},n.React.createElement(u.b,{to:"/login",className:"register__signup-link"},n.React.createElement("p",{className:"register__signup-prompt-text"},"Already registered? Log in")))))},U=a(19),D=a.n(U),I=a(20),q=a.n(I),F=function(e){var t=e.onClose,a=e.isOpen,n=e.isSuccess;return r.a.createElement(y,{isOpen:a,onClose:t},r.a.createElement("img",{className:"infotooltip__icon",src:n?D.a:q.a,alt:n?"Your registration is successful!":"Something has gone wrong. Try again!"}),r.a.createElement("h2",{className:"form__title form__title_type_infotooltip"},n?"Your registration is successful!":"Something has gone wrong. Try again!"))};var J=function(){var e=Object(s.g)(),t=r.a.useState(!1),a=Object(i.a)(t,2),n=a[0],o=a[1],c=r.a.useState({}),m=Object(i.a)(c,2),p=m[0],h=m[1],b=r.a.useState(!1),N=Object(i.a)(b,2),y=N[0],T=N[1],P=r.a.useState(!1),U=Object(i.a)(P,2),D=U[0],I=U[1],q=r.a.useState(!1),J=Object(i.a)(q,2),Y=J[0],B=J[1],G=r.a.useState(!1),z=Object(i.a)(G,2),H=z[0],V=z[1],M=r.a.useState({isOpen:!1,isSuccess:!1}),K=Object(i.a)(M,2),Q=K[0],W=K[1],X=r.a.useState({name:"",link:""}),Z=Object(i.a)(X,2),$=Z[0],ee=Z[1],te=r.a.useState(""),ae=Object(i.a)(te,2),ne=ae[0],re=ae[1],oe=r.a.useState({}),ce=Object(i.a)(oe,2),le=ce[0],ie=ce[1],se=r.a.useState([]),ue=Object(i.a)(se,2),me=ue[0],pe=ue[1],_e=function(){if(localStorage.getItem("jwt")){var e=localStorage.getItem("jwt");return d(e).then(function(e){e&&(h({password:e.data.password,email:e.data.email}),o(!0))})}};r.a.useEffect(function(){_e()},[]),r.a.useEffect(function(){n&&e.push("/")},[n]),r.a.useEffect(function(){n&&Promise.all([w.getProfile(),w.getInitialCards()]).then(function(e){var t=Object(i.a)(e,2),a=t[0],n=t[1];ie(a),pe(n)}).catch(function(e){console.log(e)})},[n]);var fe=function(){T(!1),I(!1),B(!1),V(!1),W(!1),ee({name:"",link:""})};return r.a.createElement(v.Provider,{value:le},r.a.createElement("div",{className:"page"},r.a.createElement("div",{className:"page__content"},r.a.createElement(E,null,r.a.createElement(s.b,{path:"/",exact:!0},r.a.createElement("p",{className:"header__nav-link"},p.email),r.a.createElement(u.b,{to:"/sign-in",className:"header__nav-link header__nav-link_type_exit",onClick:function(){localStorage.removeItem("jwt"),h({}),o(!1)}},"\u0412\u044b\u0439\u0442\u0438")),r.a.createElement(s.b,{path:"/sign-up"},r.a.createElement(u.b,{to:"/sign-in",className:"header__nav-link"},"Sign in")),r.a.createElement(s.b,{path:"/sign-in"},r.a.createElement(u.b,{to:"/sign-up",className:"header__nav-link"},"Register"))),r.a.createElement(s.d,null,r.a.createElement(R,{path:"/",exact:!0,loggedIn:n},r.a.createElement(C,{onEditProfile:function(){T(!0)},onAddPlace:function(){I(!0)},onEditAvatar:function(){B(!0)},onCardClick:function(e){ee(e)},onCardLike:function(e){var t=e.likes.some(function(e){return e._id===le._id});w.changeLikeCardStatus(e._id,t).then(function(t){pe(function(a){return a.map(function(a){return a._id===e._id?t:a})})}).catch(function(e){console.log(e)})},onCardDelete:function(e){V(!0),re(e)},cards:me}),r.a.createElement(S,{isOpen:y,onClose:fe,onUpdateUser:function(e){var t=e.name,a=e.about;w.editProfile(t,a).then(function(e){ie(e),fe()}).catch(function(e){console.log(e)})},buttonText:"Save",title:"Edit profile"}),r.a.createElement(O,{isOpen:Y,onClose:fe,onUpdateAvatar:function(e){var t=e.avatar;w.updateAvatar(t).then(function(e){ie(e),fe()}).catch(function(e){console.log(e)})},buttonText:"Save",title:"Update avatar"}),r.a.createElement(j,{isOpen:D,onClose:fe,onAddPlace:function(e){var t=e.name,a=e.link;w.addCard(t,a).then(function(e){pe([e].concat(Object(l.a)(me))),fe()}).catch(function(e){console.log(e)})},buttonText:"Add",title:"New place"}),r.a.createElement(k,{card:$,onClose:fe}),r.a.createElement(x,{name:"delete-confirm",isOpen:H,title:"Are you sure?",buttonText:"Yes",onClose:fe,onSubmit:function(){w.deleteCard(ne._id).then(function(){pe(function(e){return e.filter(function(e){return e._id!==ne._id})}),fe()}).catch(function(e){console.log(e)})}})),r.a.createElement(s.b,{path:"/sign-in"},r.a.createElement(L,{onLogin:function(t,a){return f(t,a).then(function(t){localStorage.setItem("jwt",t.token),_e(),o(!0),e.push("/")}).catch(function(e){W({isOpen:!0,isSuccess:!1})})},tokenCheck:_e})),r.a.createElement(s.b,{path:"/sign-up"},r.a.createElement(A,{onRegister:function(t,a){return _(t,a).then(function(){W({isOpen:!0,isSuccess:!0}),e.push("/sign-in")}).catch(function(e){W({isOpen:!0,isSuccess:!1})})}})),r.a.createElement(s.b,null,n?r.a.createElement(s.a,{to:"/"}):r.a.createElement(s.a,{to:"/sign-in"}))),r.a.createElement(F,{isOpen:Q.isOpen,onClose:fe,isSuccess:Q.isSuccess}),r.a.createElement(g,null))))},Y=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,39)).then(function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),o(e),c(e)})};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(u.a,null,r.a.createElement(J,null))),document.getElementById("root")),Y()}},[[22,1,2]]]);
//# sourceMappingURL=main.35e14377.chunk.js.map